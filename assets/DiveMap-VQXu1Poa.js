import{L as u,d as b}from"./VAutocomplete-CaKHHFVx.js";import{a as C}from"./index-DW_MHI2K.js";import{V as L}from"./VContainer-Bq8NJnTw.js";import{j as S,r as i,L as $,B as k,l as o,n as _,q as D,i as l,D as P,t as g,H as T,aa as z,ak as B,al as E,an as I,A as M,z as N,y as A}from"./index-Ca311VsR.js";import"./VTextField-DJK0lndc.js";import"./VChip-DsA3FNyy.js";const H=S({__name:"DiveMap",setup(U){const V="https://blue-diary-backend.vercel.app",c=i(""),m=i(null),d=i(!1);let r;const p={},s=i([]),v=i(null),n=i([]),y=a=>{if(!a){n.value=s.value;return}n.value=s.value.filter(e=>e.name.toLowerCase().includes(a.toLowerCase()))},w=a=>{if(!a)return;const e=s.value.find(t=>t.name===a);e&&(r.setView([e.lat,e.lng],15),p[e.name].openPopup())},f=(a,e)=>`${a.toFixed(4)}¬∞N, ${e.toFixed(4)}¬∞E`,x=async()=>{d.value=!0,v.value=null;try{const a=await C.get(`${V}/api/diveMap`);s.value=a.data,n.value=a.data,Object.values(p).forEach(e=>e.remove()),s.value.forEach(e=>{const t=u.marker([e.lat,e.lng]).bindPopup(`
          <div class="popup-content">
            <h3 class="popup-title">${e.name}</h3>
            ${e.region?`<div class="popup-region">${e.region}</div>`:""}
            ${e.description?`<div class="popup-description">${e.description}</div>`:""}
            <div class="popup-coordinates">
              <i class="popup-icon">üìç</i> ${f(e.lat,e.lng)}
            </div>
          </div>
        `,{className:"custom-popup",maxWidth:300,minWidth:200}).addTo(r);p[e.name]=t}),console.log(s.value)}catch(a){console.error("Error loading dive spots:",a),v.value="ËºâÂÖ•ÊΩõÈªûË≥áÊñôÂ§±Êïó"}finally{d.value=!1}};return $(()=>{r=u.map("map").setView([23.5,121.5],7),u.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(r),x()}),(a,e)=>(_(),k(L,{class:"fill-height pa-0",fluid:""},{default:o(()=>[e[3]||(e[3]=D("div",{id:"map",style:{height:"100%",width:"100%"}},null,-1)),l(A,{class:"map-overlay",style:{position:"absolute",bottom:"16px",left:"16px","z-index":"1000"},width:"300"},{default:o(()=>[l(P,{class:"text-h6"},{default:o(()=>e[2]||(e[2]=[g("ÊΩõÈªûÂú∞Âúñ")])),_:1}),l(T,null,{default:o(()=>[l(b,{modelValue:m.value,"onUpdate:modelValue":[e[0]||(e[0]=t=>m.value=t),w],search:c.value,"onUpdate:search":[e[1]||(e[1]=t=>c.value=t),y],items:n.value,loading:d.value,label:"ÊêúÂ∞ãÊΩõÈªû",density:"comfortable",variant:"outlined","item-title":"name","item-value":"name","hide-no-data":"","hide-details":"","prepend-inner-icon":"mdi-magnify",clearable:""},{item:o(({props:t,item:h})=>[l(z,B(E(t)),{prepend:o(()=>[l(N,{icon:"mdi-map-marker",class:"mr-2"})]),default:o(()=>[l(I,{class:"text-white"},{default:o(()=>[g(M(f(h.raw.lat,h.raw.lng)),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","search","items","loading"])]),_:1})]),_:1})]),_:1}))}});export{H as default};
