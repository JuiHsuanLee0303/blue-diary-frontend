import{L as u,d as y}from"./VAutocomplete-CBWn98Oo.js";import{a as b}from"./index-DW_MHI2K.js";import{V as L}from"./VContainer-CgAhKj_n.js";import{j as C,r as s,L as S,B as _,l as o,n as $,q as k,i as l,D as P,t as h,H as D,aa as I,ak as T,al as z,an as A,A as B,z as E,y as M}from"./index-BUUJBkJA.js";import"./VTextField-C8q4Kbh-.js";import"./VChip-CBAA9HYm.js";const H=C({__name:"DiveMap",setup(N){const c=s(""),m=s(null),d=s(!1);let n;const p={},i=s([]),v=s(null),r=s([]),V=a=>{if(!a){r.value=i.value;return}r.value=i.value.filter(e=>e.name.toLowerCase().includes(a.toLowerCase()))},w=a=>{if(!a)return;const e=i.value.find(t=>t.name===a);e&&(n.setView([e.lat,e.lng],15),p[e.name].openPopup())},f=(a,e)=>`${a.toFixed(4)}¬∞N, ${e.toFixed(4)}¬∞E`,x=async()=>{d.value=!0,v.value=null;try{const a=await b.get("undefined/api/diveMap");i.value=a.data,r.value=a.data,Object.values(p).forEach(e=>e.remove()),i.value.forEach(e=>{const t=u.marker([e.lat,e.lng]).bindPopup(`
          <div class="popup-content">
            <h3 class="popup-title">${e.name}</h3>
            ${e.region?`<div class="popup-region">${e.region}</div>`:""}
            ${e.description?`<div class="popup-description">${e.description}</div>`:""}
            <div class="popup-coordinates">
              <i class="popup-icon">üìç</i> ${f(e.lat,e.lng)}
            </div>
          </div>
        `,{className:"custom-popup",maxWidth:300,minWidth:200}).addTo(n);p[e.name]=t}),console.log(i.value)}catch(a){console.error("Error loading dive spots:",a),v.value="ËºâÂÖ•ÊΩõÈªûË≥áÊñôÂ§±Êïó"}finally{d.value=!1}};return S(()=>{n=u.map("map").setView([23.5,121.5],7),u.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(n),x()}),(a,e)=>($(),_(L,{class:"fill-height pa-0",fluid:""},{default:o(()=>[e[3]||(e[3]=k("div",{id:"map",style:{height:"100%",width:"100%"}},null,-1)),l(M,{class:"map-overlay",style:{position:"absolute",bottom:"16px",left:"16px","z-index":"1000"},width:"300"},{default:o(()=>[l(P,{class:"text-h6"},{default:o(()=>e[2]||(e[2]=[h("ÊΩõÈªûÂú∞Âúñ")])),_:1}),l(D,null,{default:o(()=>[l(y,{modelValue:m.value,"onUpdate:modelValue":[e[0]||(e[0]=t=>m.value=t),w],search:c.value,"onUpdate:search":[e[1]||(e[1]=t=>c.value=t),V],items:r.value,loading:d.value,label:"ÊêúÂ∞ãÊΩõÈªû",density:"comfortable",variant:"outlined","item-title":"name","item-value":"name","hide-no-data":"","hide-details":"","prepend-inner-icon":"mdi-magnify",clearable:""},{item:o(({props:t,item:g})=>[l(I,T(z(t)),{prepend:o(()=>[l(E,{icon:"mdi-map-marker",class:"mr-2"})]),default:o(()=>[l(A,{class:"text-white"},{default:o(()=>[h(B(f(g.raw.lat,g.raw.lng)),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","search","items","loading"])]),_:1})]),_:1})]),_:1}))}});export{H as default};
