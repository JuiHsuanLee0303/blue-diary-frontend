import{g as $e,p as qe,R as Xe,r as A,S as me,T as Ie,e as P,U as Ye,W as Ze,X as el,Y as pe,c as $,Z as Ee,$ as ce,a0 as ll,h as He,i as t,a1 as J,a2 as Ge,a3 as tl,a4 as al,a5 as nl,a6 as Me,F as q,z,a7 as ul,a8 as Ke,a9 as ol,aa as Ue,G as il,ab as rl,ac as sl,t as w,ad as dl,w as ml,L as je,o as cl,ae as vl,af as fl,f as pl,ag as Ne,ah as bl,ai as gl,aj as Vl,j as xl,P as yl,B as we,l as u,ak as wl,n as ee,q as d,O as _e,A as le,M as De,y as j,al as hl,am as kl,an as Cl,ao as Sl,s as W,ap as he,k as ke,x as Ce,D as Pl,H as _l,J as Dl,K as Tl,N as Fl,Q as Il,_ as Ul}from"./index-CehNAOiO.js";import{u as Rl}from"./diveLogService--i1kab9r.js";import{u as Al,m as Ll,L as Te,V as El}from"./VAutocomplete-E8bGMNn3.js";import{V as Ml}from"./VContainer-D245ioWJ.js";import{a as b,V as te}from"./VRow-Dj5EP_aS.js";import{V as Be}from"./VAlert-r_Do5ysX.js";import{V as Nl}from"./VForm-Cx2nzHkh.js";import{u as Bl,V as F,m as Ol,a as zl,b as Oe,f as $l,c as ql,d as Hl,e as Gl,g as Kl}from"./VTextField-Bv30GIbp.js";import{u as jl,m as Wl,V as Jl,a as Ql,b as Fe}from"./VSelect-6tFFsFbR.js";import{V as Xl}from"./VChip-WM5Ppmhe.js";function Yl(e,L,H){if(L==null)return e;if(Array.isArray(L))throw new Error("Multiple matches is not implemented");return typeof L=="number"&&~L?t(q,null,[t("span",{class:"v-combobox__unmask"},[e.substr(0,L)]),t("span",{class:"v-combobox__mask"},[e.substr(L,H)]),t("span",{class:"v-combobox__unmask"},[e.substr(L+H)])]):e}const Zl=qe({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...Ll({filterKeys:["title"]}),...Wl({hideNoData:!0,returnObject:!0}),...al(Ol({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...tl({transition:!1})},"VCombobox"),et=$e()({name:"VCombobox",props:Zl(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:search":e=>!0,"update:menu":e=>!0},setup(e,L){var Re;let{emit:H,slots:v}=L;const{t:R}=Xe(),y=A(),_=me(!1),N=me(!0),X=me(!1),Q=A(),ae=A(),ne=Ie(e,"menu"),x=P({get:()=>ne.value,set:n=>{var m;ne.value&&!n&&((m=Q.value)!=null&&m.ΨopenChildren.size)||(ne.value=n)}}),f=me(-1);let Y=!1;const Z=P(()=>{var n;return(n=y.value)==null?void 0:n.color}),ie=P(()=>x.value?e.closeText:e.openText),{items:g,transformIn:E,transformOut:re}=Ye(e),{textColorClasses:o,textColorStyles:se}=Ze(Z),s=Ie(e,"modelValue",[],n=>E(el(n)),n=>{const m=re(n);return e.multiple?m:m[0]??null}),B=Bl(e),G=P(()=>!!(e.chips||v.chip)),C=P(()=>G.value||!!v.selection),k=me(!e.multiple&&!C.value?((Re=s.value[0])==null?void 0:Re.title)??"":""),i=P({get:()=>k.value,set:n=>{var m;if(k.value=n??"",!e.multiple&&!C.value&&(s.value=[pe(e,n)]),n&&e.multiple&&((m=e.delimiters)!=null&&m.length)){const h=n.split(new RegExp(`(?:${e.delimiters.join("|")})+`));h.length>1&&(h.forEach(c=>{c=c.trim(),c&&K(pe(e,c))}),k.value="")}n||(f.value=-1),N.value=!n}}),D=P(()=>typeof e.counterValue=="function"?e.counterValue(s.value):typeof e.counterValue=="number"?e.counterValue:e.multiple?s.value.length:i.value.length);$(k,n=>{Y?ce(()=>Y=!1):_.value&&!x.value&&(x.value=!0),H("update:search",n)}),$(s,n=>{var m;!e.multiple&&!C.value&&(k.value=((m=n[0])==null?void 0:m.title)??"")});const{filteredItems:V,getMatches:T}=Al(e,g,()=>N.value?"":i.value),I=P(()=>e.hideSelected?V.value.filter(n=>!s.value.some(m=>m.value===n.value)):V.value),ue=P(()=>s.value.map(n=>n.value)),r=P(()=>{var m;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&i.value===((m=I.value[0])==null?void 0:m.title))&&I.value.length>0&&!N.value&&!X.value}),l=P(()=>e.hideNoData&&!I.value.length||B.isReadonly.value||B.isDisabled.value),a=A(),S=jl(a,y);function ve(n){Y=!0,e.openOnClear&&(x.value=!0)}function fe(){l.value||(x.value=!0)}function be(n){l.value||(_.value&&(n.preventDefault(),n.stopPropagation()),x.value=!x.value)}function Se(n){var m;n.key!==" "&&Me(n)&&((m=y.value)==null||m.focus())}function ge(n){var c;if(nl(n)||B.isReadonly.value)return;const m=y.value.selectionStart,h=s.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(n.key)&&n.preventDefault(),["Enter","ArrowDown"].includes(n.key)&&(x.value=!0),["Escape"].includes(n.key)&&(x.value=!1),["Enter","Escape","Tab"].includes(n.key)&&(r.value&&["Enter","Tab"].includes(n.key)&&!s.value.some(p=>{let{value:O}=p;return O===I.value[0].value})&&K(V.value[0]),N.value=!0),n.key==="ArrowDown"&&r.value&&((c=a.value)==null||c.focus("next")),n.key==="Enter"&&i.value&&(K(pe(e,i.value)),C.value&&(k.value="")),["Backspace","Delete"].includes(n.key)){if(!e.multiple&&C.value&&s.value.length>0&&!i.value)return K(s.value[0],!1);if(~f.value){n.preventDefault();const p=f.value;K(s.value[f.value],!1),f.value=p>=h-1?h-2:p}else n.key==="Backspace"&&!i.value&&(f.value=h-1);return}if(e.multiple)if(n.key==="ArrowLeft"){if(f.value<0&&m>0)return;const p=f.value>-1?f.value-1:h-1;s.value[p]?f.value=p:(f.value=-1,y.value.setSelectionRange(i.value.length,i.value.length))}else if(n.key==="ArrowRight"){if(f.value<0)return;const p=f.value+1;s.value[p]?f.value=p:(f.value=-1,y.value.setSelectionRange(0,0))}else~f.value&&Me(n)&&(f.value=-1)}function Ve(){var n;e.eager&&((n=ae.value)==null||n.calculateVisibleItems())}function Pe(){var n;_.value&&(N.value=!0,(n=y.value)==null||n.focus())}function K(n){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!n||n.props.disabled))if(e.multiple){const h=s.value.findIndex(p=>(e.valueComparator||Ee)(p.value,n.value)),c=m??!~h;if(~h){const p=c?[...s.value,n]:[...s.value];p.splice(h,1),s.value=p}else c&&(s.value=[...s.value,n]);e.clearOnSelect&&(i.value="")}else{const h=m!==!1;s.value=h?[n]:[],k.value=h&&!C.value?n.title:"",ce(()=>{x.value=!1,N.value=!0})}}function We(n){_.value=!0,setTimeout(()=>{X.value=!0})}function Je(n){X.value=!1}function Qe(n){(n==null||n===""&&!e.multiple&&!C.value)&&(s.value=[])}return $(_,(n,m)=>{if(!(n||n===m)&&(f.value=-1,x.value=!1,i.value)){if(e.multiple){K(pe(e,i.value));return}if(!C.value)return;s.value.some(h=>{let{title:c}=h;return c===i.value})?k.value="":K(pe(e,i.value))}}),$(x,()=>{if(!e.hideSelected&&x.value&&s.value.length){const n=I.value.findIndex(m=>s.value.some(h=>(e.valueComparator||Ee)(h.value,m.value)));ll&&window.requestAnimationFrame(()=>{var m;n>=0&&((m=ae.value)==null||m.scrollToIndex(n))})}}),$(()=>e.items,(n,m)=>{x.value||_.value&&!m.length&&n.length&&(x.value=!0)}),He(()=>{const n=!!(!e.hideNoData||I.value.length||v["prepend-item"]||v["append-item"]||v["no-data"]),m=s.value.length>0,h=F.filterProps(e);return t(F,J({ref:y},h,{modelValue:i.value,"onUpdate:modelValue":[c=>i.value=c,Qe],focused:_.value,"onUpdate:focused":c=>_.value=c,validationValue:s.externalValue,counterValue:D.value,dirty:m,class:["v-combobox",{"v-combobox--active-menu":x.value,"v-combobox--chips":!!e.chips,"v-combobox--selection-slot":!!C.value,"v-combobox--selecting-index":f.value>-1,[`v-combobox--${e.multiple?"multiple":"single"}`]:!0},e.class],style:e.style,readonly:B.isReadonly.value,placeholder:m?void 0:e.placeholder,"onClick:clear":ve,"onMousedown:control":fe,onKeydown:ge}),{...v,default:()=>t(q,null,[t(Ke,J({ref:Q,modelValue:x.value,"onUpdate:modelValue":c=>x.value=c,activator:"parent",contentClass:"v-combobox__content",disabled:l.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:Ve,onAfterLeave:Pe},e.menuProps),{default:()=>[n&&t(ol,J({ref:a,selected:ue.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:c=>c.preventDefault(),onKeydown:Se,onFocusin:We,onFocusout:Je,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},S,e.listProps),{default:()=>{var c,p,O;return[(c=v["prepend-item"])==null?void 0:c.call(v),!I.value.length&&!e.hideNoData&&(((p=v["no-data"])==null?void 0:p.call(v))??t(Ue,{key:"no-data",title:R(e.noDataText)},null)),t(Jl,{ref:ae,renderless:!0,items:I.value},{default:oe=>{var Le;let{item:U,index:de,itemRef:M}=oe;const Ae=J(U.props,{ref:M,key:U.value,active:r.value&&de===0?!0:void 0,onClick:()=>K(U,null)});return((Le=v.item)==null?void 0:Le.call(v,{item:U,index:de,props:Ae}))??t(Ue,J(Ae,{role:"option"}),{prepend:xe=>{let{isSelected:ye}=xe;return t(q,null,[e.multiple&&!e.hideSelected?t(Ql,{key:U.value,modelValue:ye,ripple:!1,tabindex:"-1"},null):void 0,U.props.prependAvatar&&t(il,{image:U.props.prependAvatar},null),U.props.prependIcon&&t(z,{icon:U.props.prependIcon},null)])},title:()=>{var xe,ye;return N.value?U.title:Yl(U.title,(xe=T(U))==null?void 0:xe.title,((ye=i.value)==null?void 0:ye.length)??0)}})}}),(O=v["append-item"])==null?void 0:O.call(v)]}})]}),s.value.map((c,p)=>{function O(M){M.stopPropagation(),M.preventDefault(),K(c,!1)}const oe={"onClick:close":O,onKeydown(M){M.key!=="Enter"&&M.key!==" "||(M.preventDefault(),M.stopPropagation(),O(M))},onMousedown(M){M.preventDefault(),M.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},U=G.value?!!v.chip:!!v.selection,de=U?rl(G.value?v.chip({item:c,index:p,props:oe}):v.selection({item:c,index:p})):void 0;if(!(U&&!de))return t("div",{key:c.value,class:["v-combobox__selection",p===f.value&&["v-combobox__selection--selected",o.value]],style:p===f.value?se.value:{}},[G.value?v.chip?t(sl,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:c.title}}},{default:()=>[de]}):t(Xl,J({key:"chip",closable:e.closableChips,size:"small",text:c.title,disabled:c.props.disabled},oe),null):de??t("span",{class:"v-combobox__selection-text"},[c.title,e.multiple&&p<s.value.length-1&&t("span",{class:"v-combobox__selection-comma"},[w(",")])])])})]),"append-inner":function(){var oe;for(var c=arguments.length,p=new Array(c),O=0;O<c;O++)p[O]=arguments[O];return t(q,null,[(oe=v["append-inner"])==null?void 0:oe.call(v,...p),(!e.hideNoData||e.items.length)&&e.menuIcon?t(z,{class:"v-combobox__menu-icon",icon:e.menuIcon,onMousedown:be,onClick:ul,"aria-label":R(ie.value),title:R(ie.value),tabindex:"-1"},null):void 0])}})}),Ge({isFocused:_,isPristine:N,menu:x,search:i,selectionIndex:f,filteredItems:V,select:K},y)}}),lt=qe({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...Hl(),...ql()},"VTextarea"),ze=$e()({name:"VTextarea",directives:{Intersect:dl},inheritAttrs:!1,props:lt(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,L){let{attrs:H,emit:v,slots:R}=L;const y=Ie(e,"modelValue"),{isFocused:_,focus:N,blur:X}=zl(e),Q=P(()=>typeof e.counterValue=="function"?e.counterValue(y.value):(y.value||"").toString().length),ae=P(()=>{if(H.maxlength)return H.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function ne(i,D){var V,T;!e.autofocus||!i||(T=(V=D[0].target)==null?void 0:V.focus)==null||T.call(V)}const x=A(),f=A(),Y=me(""),Z=A(),ie=P(()=>e.persistentPlaceholder||_.value||e.active);function g(){var i;Z.value!==document.activeElement&&((i=Z.value)==null||i.focus()),_.value||N()}function E(i){g(),v("click:control",i)}function re(i){v("mousedown:control",i)}function o(i){i.stopPropagation(),g(),ce(()=>{y.value="",Vl(e["onClick:clear"],i)})}function se(i){var V;const D=i.target;if(y.value=D.value,(V=e.modelModifiers)!=null&&V.trim){const T=[D.selectionStart,D.selectionEnd];ce(()=>{D.selectionStart=T[0],D.selectionEnd=T[1]})}}const s=A(),B=A(+e.rows),G=P(()=>["plain","underlined"].includes(e.variant));ml(()=>{e.autoGrow||(B.value=+e.rows)});function C(){e.autoGrow&&ce(()=>{if(!s.value||!f.value)return;const i=getComputedStyle(s.value),D=getComputedStyle(f.value.$el),V=parseFloat(i.getPropertyValue("--v-field-padding-top"))+parseFloat(i.getPropertyValue("--v-input-padding-top"))+parseFloat(i.getPropertyValue("--v-field-padding-bottom")),T=s.value.scrollHeight,I=parseFloat(i.lineHeight),ue=Math.max(parseFloat(e.rows)*I+V,parseFloat(D.getPropertyValue("--v-input-control-height"))),r=parseFloat(e.maxRows)*I+V||1/0,l=pl(T??0,ue,r);B.value=Math.floor((l-V)/I),Y.value=fl(l)})}je(C),$(y,C),$(()=>e.rows,C),$(()=>e.maxRows,C),$(()=>e.density,C);let k;return $(s,i=>{i?(k=new ResizeObserver(C),k.observe(s.value)):k==null||k.disconnect()}),cl(()=>{k==null||k.disconnect()}),He(()=>{const i=!!(R.counter||e.counter||e.counterValue),D=!!(i||R.details),[V,T]=vl(H),{modelValue:I,...ue}=Oe.filterProps(e),r=$l(e);return t(Oe,J({ref:x,modelValue:y.value,"onUpdate:modelValue":l=>y.value=l,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":G.value},e.class],style:e.style},V,ue,{centerAffix:B.value===1&&!G.value,focused:_.value}),{...R,default:l=>{let{id:a,isDisabled:S,isDirty:ve,isReadonly:fe,isValid:be}=l;return t(Kl,J({ref:f,style:{"--v-textarea-control-height":Y.value},onClick:E,onMousedown:re,"onClick:clear":o,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},r,{id:a.value,active:ie.value||ve.value,centerAffix:B.value===1&&!G.value,dirty:ve.value||e.dirty,disabled:S.value,focused:_.value,error:be.value===!1}),{...R,default:Se=>{let{props:{class:ge,...Ve}}=Se;return t(q,null,[e.prefix&&t("span",{class:"v-text-field__prefix"},[e.prefix]),Ne(t("textarea",J({ref:Z,class:ge,value:y.value,onInput:se,autofocus:e.autofocus,readonly:fe.value,disabled:S.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:g,onBlur:X},Ve,T),null),[[bl("intersect"),{handler:ne},null,{once:!0}]]),e.autoGrow&&Ne(t("textarea",{class:[ge,"v-textarea__sizer"],id:`${Ve.id}-sizer`,"onUpdate:modelValue":Pe=>y.value=Pe,ref:s,readonly:!0,"aria-hidden":"true"},null),[[gl,y.value]]),e.suffix&&t("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:D?l=>{var a;return t(q,null,[(a=R.details)==null?void 0:a.call(R,l),i&&t(q,null,[t("span",null,null),t(Gl,{active:e.persistentCounter||_.value,value:Q.value,max:ae.value,disabled:e.disabled},R.counter)])])}:void 0})}),Ge({},x,f,Z)}}),tt={class:"text-h4 mb-6"},at={class:"form-section"},nt={class:"text-h6 mb-4 d-flex align-center"},ut={class:"form-section"},ot={class:"text-h6 mb-4 mt-6 d-flex align-center"},it={class:"form-section"},rt={class:"text-h6 mb-4 mt-6 d-flex align-center"},st={class:"form-section"},dt={class:"text-h6 mb-4 mt-6 d-flex align-center"},mt={class:"form-section"},ct={class:"text-h6 mb-4 mt-6 d-flex align-center"},vt={class:"form-section"},ft={class:"text-h6 mb-4 mt-6 d-flex align-center"},pt={class:"form-section"},bt={class:"text-h6 mb-4 mt-6 d-flex align-center"},gt={class:"d-flex gap-4 mt-6"},Vt=xl({__name:"DiveLogForm",setup(e){const L="https://blue-diary-backend.vercel.app",H=Il(),v=yl(),{createDiveLog:R,updateDiveLog:y,getDiveLog:_,loading:N,error:X}=Rl(),Q=P(()=>!!v.params.id),ae=["晴天","多雲","陰天","雨天"],ne=[{text:"海洋",value:"ocean",icon:"mdi-waves"},{text:"湖泊",value:"lake",icon:"mdi-water"},{text:"洞穴",value:"cave",icon:"mdi-tunnel"}],x=[{text:"岸潛",value:"shore",icon:"mdi-shore"},{text:"船潛",value:"boat",icon:"mdi-sail-boat"}],f=[{text:"無",value:"none",icon:"mdi-current-dc"},{text:"弱",value:"weak",icon:"mdi-arrow-right"},{text:"中",value:"medium",icon:"mdi-arrow-right-bold"},{text:"強",value:"strong",icon:"mdi-arrow-right-bold-outline"}],Y=[{text:"平靜",value:"calm",icon:"mdi-wave"},{text:"小浪",value:"small",icon:"mdi-waves"},{text:"中浪",value:"medium",icon:"mdi-waves"},{text:"大浪",value:"rough",icon:"mdi-waves"}],Z=["鋁","鋼"],ie=["BCD","調節器","面鏡","蛙鞋","防寒衣","電腦錶","指北針","SMB"],g=r=>!!r||"此欄位為必填",E=r=>r>0||"請輸入大於 0 的數值",re=A(null),o=A({name:"",date:new Date().toISOString().split("T")[0],time:"",location:"",airTemp:0,waterTemp:0,weather:"",waterType:"ocean",diveType:"shore",current:"none",waveCondition:"calm",maxDepth:0,duration:0,weight:0,visibility:0,tankType:"",tankVolume:0,startPressure:0,endPressure:0,buddies:[],diveShop:"",equipment:[],images:"",notes:""}),se=P(()=>{const r=Number(o.value.startPressure),l=Number(o.value.endPressure);return r&&l&&r>=l?r-l:null}),s=P(()=>{const r=se.value,l=Number(o.value.duration),a=Number(o.value.maxDepth),S=Number(o.value.tankVolume);if(r&&l&&a&&S){const fe=a/2/10+1;return(r*S/(l*fe)).toFixed(1)}return null}),B=()=>{const r=Number(o.value.startPressure),l=Number(o.value.endPressure);r&&l&&l>r&&(o.value.endPressure=o.value.startPressure)},G=r=>{if(!r)return!0;const l=r.split(`
`).filter(a=>a.trim());for(const a of l)if(!a.match(/^https?:\/\/.+/))return"請輸入有效的圖片連結（以 http:// 或 https:// 開頭）";return!0},C=async()=>{var r;if(Q.value){const l=await _(v.params.id);l&&(o.value={...l,images:((r=l.images)==null?void 0:r.join(`
`))||""})}},k=async()=>{var l;const r=await((l=re.value)==null?void 0:l.validate());if(r!=null&&r.valid)try{o.value.name.trim()||(o.value.name=`${o.value.date}_${o.value.time}_${o.value.location}`);const a={...o.value,images:o.value.images.split(`
`).map(S=>S.trim()).filter(S=>S)};Q.value?await y(v.params.id,a):await R(a),H.push("/dive-log")}catch(a){console.error("Error submitting form:",a)}},i=A([]),D=A(!1),V=A(!1);let T=null;const I=async()=>{D.value=!0;try{const r=await wl.get(`${L}/api/diveMap`);i.value=r.data}catch(r){console.error("Error loading dive spots:",r)}finally{D.value=!1}},ue=(r,l)=>{var S;if(!l)return!0;const a=l.toLowerCase();return r.name.toLowerCase().includes(a)||((S=r.region)==null?void 0:S.toLowerCase().includes(a))};return $(V,async r=>{r&&(await ce(),T||(T=Te.map("select-map").setView([23.5,121.5],7),Te.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(T)),i.value.forEach(l=>{T&&Te.marker([l.lat,l.lng]).bindPopup(l.name).on("click",()=>{o.value.location=l.name,V.value=!1}).addTo(T)}))}),je(()=>{I(),Q.value&&C()}),(r,l)=>(ee(),we(Ml,null,{default:u(()=>[t(te,null,{default:u(()=>[t(b,{cols:"12"},{default:u(()=>[d("h1",tt,le(Q.value?"編輯潛水日誌":"新增潛水日誌"),1),De(X)?(ee(),we(Be,{key:0,type:"error",variant:"tonal",closable:"",class:"mb-4"},{default:u(()=>[w(le(De(X)),1)]),_:1})):_e("",!0),t(Nl,{ref_key:"form",ref:re},{default:u(()=>[t(j,{class:"pa-6"},{default:u(()=>[d("div",at,[d("h2",nt,[t(z,{icon:"mdi-information",class:"mr-2"}),l[28]||(l[28]=w(" 基本資訊 "))]),t(j,{class:"pa-4 mb-4",variant:"flat"},{default:u(()=>[t(te,null,{default:u(()=>[t(b,{cols:"12"},{default:u(()=>[t(F,{modelValue:o.value.name,"onUpdate:modelValue":l[0]||(l[0]=a=>o.value.name=a),label:"日誌名稱",variant:"outlined","prepend-inner-icon":"mdi-format-title",hint:"若未填寫將自動使用「日期_時間_潛點」格式","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(b,{cols:"12",md:"6"},{default:u(()=>[t(F,{modelValue:o.value.date,"onUpdate:modelValue":l[1]||(l[1]=a=>o.value.date=a),label:"潛水日期",type:"date",required:"",variant:"outlined","prepend-inner-icon":"mdi-calendar",rules:[g]},null,8,["modelValue","rules"])]),_:1}),t(b,{cols:"12",md:"6"},{default:u(()=>[t(F,{modelValue:o.value.time,"onUpdate:modelValue":l[2]||(l[2]=a=>o.value.time=a),label:"潛水時間",type:"time",required:"",variant:"outlined","prepend-inner-icon":"mdi-clock",rules:[g]},null,8,["modelValue","rules"])]),_:1}),t(b,{cols:"12"},{default:u(()=>[t(El,{modelValue:o.value.location,"onUpdate:modelValue":l[4]||(l[4]=a=>o.value.location=a),items:i.value,loading:D.value,label:"潛點位置",required:"",variant:"outlined","prepend-inner-icon":"mdi-map-marker","item-title":"name","item-value":"name",filter:ue,"hide-no-data":"",rules:[g]},{"append-inner":u(()=>[t(W,{icon:"mdi-map",variant:"text",onClick:l[3]||(l[3]=a=>V.value=!0)})]),item:u(({props:a,item:S})=>[t(Ue,hl(kl(a)),{prepend:u(()=>[t(z,{icon:"mdi-map-marker"})]),default:u(()=>[t(Cl,null,{default:u(()=>[w(le(S.raw.name),1)]),_:2},1024),S.raw.region?(ee(),we(Sl,{key:0},{default:u(()=>[w(le(S.raw.region),1)]),_:2},1024)):_e("",!0)]),_:2},1040)]),_:1},8,["modelValue","items","loading","rules"])]),_:1})]),_:1})]),_:1})]),d("div",ut,[d("h2",ot,[t(z,{icon:"mdi-weather-partly-cloudy",class:"mr-2"}),l[29]||(l[29]=w(" 環境資訊 "))]),t(j,{class:"pa-4 mb-4",variant:"flat"},{default:u(()=>[t(te,null,{default:u(()=>[t(b,{cols:"12",md:"4"},{default:u(()=>[t(F,{modelValue:o.value.airTemp,"onUpdate:modelValue":l[5]||(l[5]=a=>o.value.airTemp=a),label:"氣溫 (°C)",type:"number",variant:"outlined","prepend-inner-icon":"mdi-thermometer",rules:[g,E]},null,8,["modelValue","rules"])]),_:1}),t(b,{cols:"12",md:"4"},{default:u(()=>[t(F,{modelValue:o.value.waterTemp,"onUpdate:modelValue":l[6]||(l[6]=a=>o.value.waterTemp=a),label:"水溫 (°C)",type:"number",required:"",variant:"outlined","prepend-inner-icon":"mdi-thermometer-water",rules:[g,E]},null,8,["modelValue","rules"])]),_:1}),t(b,{cols:"12",md:"4"},{default:u(()=>[t(Fe,{modelValue:o.value.weather,"onUpdate:modelValue":l[7]||(l[7]=a=>o.value.weather=a),label:"天氣",items:ae,variant:"outlined","prepend-inner-icon":"mdi-weather-partly-cloudy",rules:[g]},null,8,["modelValue","rules"])]),_:1}),t(b,{cols:"12",md:"6"},{default:u(()=>[l[30]||(l[30]=d("label",{class:"text-subtitle-1 mb-2 d-block text-white"},"水域類型",-1)),t(he,{modelValue:o.value.waterType,"onUpdate:modelValue":l[8]||(l[8]=a=>o.value.waterType=a),mandatory:"",color:"primary",density:"comfortable",class:"mb-2",rules:[g]},{default:u(()=>[(ee(),ke(q,null,Ce(ne,a=>t(W,{key:a.value,value:a.value,"prepend-icon":a.icon},{default:u(()=>[w(le(a.text),1)]),_:2},1032,["value","prepend-icon"])),64))]),_:1},8,["modelValue","rules"])]),_:1}),t(b,{cols:"12",md:"6"},{default:u(()=>[l[31]||(l[31]=d("label",{class:"text-subtitle-1 mb-2 d-block text-white"},"潛水型態",-1)),t(he,{modelValue:o.value.diveType,"onUpdate:modelValue":l[9]||(l[9]=a=>o.value.diveType=a),mandatory:"",color:"primary",density:"comfortable",class:"mb-2",rules:[g]},{default:u(()=>[(ee(),ke(q,null,Ce(x,a=>t(W,{key:a.value,value:a.value,"prepend-icon":a.icon},{default:u(()=>[w(le(a.text),1)]),_:2},1032,["value","prepend-icon"])),64))]),_:1},8,["modelValue","rules"])]),_:1}),t(b,{cols:"12",md:"6"},{default:u(()=>[l[32]||(l[32]=d("label",{class:"text-subtitle-1 mb-2 d-block text-white"},"水流",-1)),t(he,{modelValue:o.value.current,"onUpdate:modelValue":l[10]||(l[10]=a=>o.value.current=a),mandatory:"",color:"primary",density:"comfortable",class:"mb-2",rules:[g]},{default:u(()=>[(ee(),ke(q,null,Ce(f,a=>t(W,{key:a.value,value:a.value,"prepend-icon":a.icon},{default:u(()=>[w(le(a.text),1)]),_:2},1032,["value","prepend-icon"])),64))]),_:1},8,["modelValue","rules"])]),_:1}),t(b,{cols:"12",md:"6"},{default:u(()=>[l[33]||(l[33]=d("label",{class:"text-subtitle-1 mb-2 d-block text-white"},"浪況",-1)),t(he,{modelValue:o.value.waveCondition,"onUpdate:modelValue":l[11]||(l[11]=a=>o.value.waveCondition=a),mandatory:"",color:"primary",density:"comfortable",class:"mb-2",rules:[g]},{default:u(()=>[(ee(),ke(q,null,Ce(Y,a=>t(W,{key:a.value,value:a.value,"prepend-icon":a.icon},{default:u(()=>[w(le(a.text),1)]),_:2},1032,["value","prepend-icon"])),64))]),_:1},8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),d("div",it,[d("h2",rt,[t(z,{icon:"mdi-chart-line",class:"mr-2"}),l[34]||(l[34]=w(" 潛水數據 "))]),t(j,{class:"pa-4 mb-4",variant:"flat"},{default:u(()=>[t(te,null,{default:u(()=>[t(b,{cols:"12",md:"3"},{default:u(()=>[t(F,{modelValue:o.value.maxDepth,"onUpdate:modelValue":l[12]||(l[12]=a=>o.value.maxDepth=a),label:"最大深度 (m)",type:"number",required:"",variant:"outlined","prepend-inner-icon":"mdi-arrow-collapse-down",rules:[g,E]},null,8,["modelValue","rules"])]),_:1}),t(b,{cols:"12",md:"3"},{default:u(()=>[t(F,{modelValue:o.value.duration,"onUpdate:modelValue":l[13]||(l[13]=a=>o.value.duration=a),label:"潛水時間 (分鐘)",type:"number",required:"",variant:"outlined","prepend-inner-icon":"mdi-timer",rules:[g,E]},null,8,["modelValue","rules"])]),_:1}),t(b,{cols:"12",md:"3"},{default:u(()=>[t(F,{modelValue:o.value.weight,"onUpdate:modelValue":l[14]||(l[14]=a=>o.value.weight=a),label:"配重 (kg)",type:"number",variant:"outlined","prepend-inner-icon":"mdi-weight",rules:[g,E]},null,8,["modelValue","rules"])]),_:1}),t(b,{cols:"12",md:"3"},{default:u(()=>[t(F,{modelValue:o.value.visibility,"onUpdate:modelValue":l[15]||(l[15]=a=>o.value.visibility=a),label:"能見度 (m)",type:"number",variant:"outlined","prepend-inner-icon":"mdi-eye",rules:[g,E]},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),d("div",st,[d("h2",dt,[t(z,{icon:"mdi-gas-cylinder",class:"mr-2"}),l[35]||(l[35]=w(" 氣瓶資訊 "))]),t(j,{class:"pa-4 mb-4",variant:"flat"},{default:u(()=>[t(te,null,{default:u(()=>[t(b,{cols:"12",md:"6"},{default:u(()=>[t(Fe,{modelValue:o.value.tankType,"onUpdate:modelValue":l[16]||(l[16]=a=>o.value.tankType=a),label:"氣瓶類型",items:Z,variant:"outlined",density:"comfortable","prepend-inner-icon":"mdi-diving-scuba-tank",rules:[g]},null,8,["modelValue","rules"])]),_:1}),t(b,{cols:"12",md:"6"},{default:u(()=>[t(F,{modelValue:o.value.tankVolume,"onUpdate:modelValue":l[17]||(l[17]=a=>o.value.tankVolume=a),label:"氣瓶容量 (L)",type:"number",variant:"outlined","prepend-inner-icon":"mdi-cube-outline",hint:"例：8L、12L","persistent-hint":"",rules:[g,E]},null,8,["modelValue","rules"])]),_:1}),t(b,{cols:"12",md:"4"},{default:u(()=>[t(F,{modelValue:o.value.startPressure,"onUpdate:modelValue":[l[18]||(l[18]=a=>o.value.startPressure=a),B],label:"起始氣壓 (bar)",type:"number",variant:"outlined",density:"comfortable","prepend-inner-icon":"mdi-gauge",min:"0",max:"300",rules:[g,E]},null,8,["modelValue","rules"])]),_:1}),t(b,{cols:"12",md:"4"},{default:u(()=>[t(F,{modelValue:o.value.endPressure,"onUpdate:modelValue":[l[19]||(l[19]=a=>o.value.endPressure=a),B],label:"結束氣壓 (bar)",type:"number",variant:"outlined",density:"comfortable","prepend-inner-icon":"mdi-gauge-empty",min:"0",max:"300",rules:[g,E]},null,8,["modelValue","rules"])]),_:1}),t(b,{cols:"12",md:"4"},{default:u(()=>[t(F,{"model-value":se.value,label:"消耗氣壓 (bar)",readonly:"",variant:"outlined",density:"comfortable","prepend-inner-icon":"mdi-gauge-low"},null,8,["model-value"])]),_:1}),s.value?(ee(),we(b,{key:0,cols:"12"},{default:u(()=>[t(Be,{color:"info",variant:"tonal",text:`根據您的潛水數據，您的耗氣率 (SAC) 為 ${s.value} L/min`,class:"mb-0"},{prepend:u(()=>[t(z,{icon:"mdi-information"})]),_:1},8,["text"])]),_:1})):_e("",!0)]),_:1})]),_:1})]),d("div",mt,[d("h2",ct,[t(z,{icon:"mdi-account-group",class:"mr-2"}),l[36]||(l[36]=w(" 夥伴資訊 "))]),t(j,{class:"pa-4 mb-4",variant:"flat"},{default:u(()=>[t(te,null,{default:u(()=>[t(b,{cols:"12",md:"6"},{default:u(()=>[t(et,{modelValue:o.value.buddies,"onUpdate:modelValue":l[20]||(l[20]=a=>o.value.buddies=a),label:"潛伴",multiple:"",chips:"",variant:"outlined","prepend-inner-icon":"mdi-account-group"},null,8,["modelValue"])]),_:1}),t(b,{cols:"12",md:"6"},{default:u(()=>[t(F,{modelValue:o.value.diveShop,"onUpdate:modelValue":l[21]||(l[21]=a=>o.value.diveShop=a),label:"潛店名稱",variant:"outlined","prepend-inner-icon":"mdi-store"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),d("div",vt,[d("h2",ft,[t(z,{icon:"mdi-diving-scuba-tank",class:"mr-2"}),l[37]||(l[37]=w(" 裝備清單 "))]),t(j,{class:"pa-4 mb-4",variant:"flat"},{default:u(()=>[t(te,null,{default:u(()=>[t(b,{cols:"12"},{default:u(()=>[t(Fe,{modelValue:o.value.equipment,"onUpdate:modelValue":l[22]||(l[22]=a=>o.value.equipment=a),label:"使用裝備",items:ie,multiple:"",chips:"",variant:"outlined","prepend-inner-icon":"mdi-diving-scuba-tank",rules:[g]},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),d("div",pt,[d("h2",bt,[t(z,{icon:"mdi-image-multiple",class:"mr-2"}),l[38]||(l[38]=w(" 照片和筆記 "))]),t(j,{class:"pa-4 mb-4",variant:"flat"},{default:u(()=>[t(te,null,{default:u(()=>[t(b,{cols:"12"},{default:u(()=>[t(ze,{modelValue:o.value.images,"onUpdate:modelValue":l[23]||(l[23]=a=>o.value.images=a),label:"照片",variant:"outlined",rows:"3","prepend-inner-icon":"mdi-image-multiple",hint:"每行輸入一個圖片連結","persistent-hint":"",rules:[G]},{"append-inner":u(()=>[t(Ke,{location:"bottom end"},{activator:u(({props:a})=>[t(W,J({icon:"mdi-help-circle",variant:"text",density:"comfortable"},a),null,16)]),default:u(()=>[t(j,{class:"pa-4","max-width":"400"},{default:u(()=>l[39]||(l[39]=[d("h3",{class:"text-h6 mb-2"},"如何添加圖片？",-1),d("p",{class:"mb-4"},"您可以使用以下方式添加圖片：",-1),d("ol",{class:"mb-4"},[d("li",{class:"mb-2"},[d("strong",null,"Google Drive："),d("ol",{class:"ml-4"},[d("li",null,"上傳圖片到 Google Drive"),d("li",null,"右鍵點擊圖片 > 分享 > 複製連結"),d("li",null,"確保連結權限設為「任何人都可以查看」"),d("li",null,"將連結貼上到此處")])]),d("li",{class:"mb-2"},[d("strong",null,"免費圖庫："),d("ul",{class:"ml-4"},[d("li",null,[d("a",{href:"https://imgur.com",target:"_blank",class:"text-decoration-none"}," Imgur "),w(" - 免費圖片上傳服務 ")]),d("li",null,[d("a",{href:"https://postimages.org",target:"_blank",class:"text-decoration-none"}," PostImages "),w(" - 無需註冊的圖片上傳 ")])])])],-1),d("p",{class:"text-caption"}," 注意：請確保圖片連結是公開可訪問的，且以 http:// 或 https:// 開頭 ",-1)])),_:1})]),_:1})]),_:1},8,["modelValue","rules"])]),_:1}),t(b,{cols:"12"},{default:u(()=>[t(ze,{modelValue:o.value.notes,"onUpdate:modelValue":l[24]||(l[24]=a=>o.value.notes=a),label:"潛水筆記",variant:"outlined",rows:"4","prepend-inner-icon":"mdi-notebook",hint:"記錄遇到的生物、特殊經歷或心得","persistent-hint":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),d("div",gt,[t(W,{color:"primary",size:"large","prepend-icon":"mdi-check",loading:De(N),class:"mr-4",onClick:k},{default:u(()=>l[40]||(l[40]=[w(" 上傳日誌 ")])),_:1},8,["loading"]),t(W,{variant:"outlined",size:"large","prepend-icon":"mdi-content-save",class:"mr-4"},{default:u(()=>l[41]||(l[41]=[w(" 存為草稿 ")])),_:1}),t(W,{variant:"outlined",size:"large","prepend-icon":"mdi-close",onClick:l[25]||(l[25]=a=>r.$router.back())},{default:u(()=>l[42]||(l[42]=[w(" 取消 ")])),_:1})])]),_:1})]),_:1},512)]),_:1})]),_:1}),t(Fl,{modelValue:V.value,"onUpdate:modelValue":l[27]||(l[27]=a=>V.value=a),width:"800"},{default:u(()=>[t(j,{class:"w-full mx-0"},{default:u(()=>[t(Pl,null,{default:u(()=>l[43]||(l[43]=[w("從地圖選擇潛點")])),_:1}),t(_l,null,{default:u(()=>l[44]||(l[44]=[d("div",{id:"select-map",style:{height:"500px"}},null,-1)])),_:1}),t(Dl,null,{default:u(()=>[t(Tl),t(W,{color:"primary",onClick:l[26]||(l[26]=a=>V.value=!1)},{default:u(()=>l[45]||(l[45]=[w("關閉")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),Tt=Ul(Vt,[["__scopeId","data-v-ac91090b"]]);export{Tt as default};
